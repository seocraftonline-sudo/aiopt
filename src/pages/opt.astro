---
import Layout from '../layouts/Layout.astro';
import Nav from '../components/Nav.astro';
---
<Layout>
<Nav/>
<main class="mn">
<header class="hd">
<h1 class="tl">Content Optimizer</h1>
<p class="st">Enhance content for better engagement</p>
</header>
<div class="gr">
<div class="sc">
<textarea class="tx" id="content" placeholder="Paste your content to optimize..."></textarea>
<button class="bt" id="optimizeBtn">Optimize Content</button>
</div>
<div class="sc" id="metricsPanel">
<div class="mt">
<div class="mt-it">
<span class="mt-lb">Readability</span>
<div class="mt-br">
<div class="mt-fl" id="readabilityBar" style="width:0%"></div>
</div>
<span class="mt-vl" id="readabilityVal">-</span>
</div>
<div class="mt-it">
<span class="mt-lb">Engagement</span>
<div class="mt-br">
<div class="mt-fl" id="engagementBar" style="width:0%"></div>
</div>
<span class="mt-vl" id="engagementVal">-</span>
</div>
<div class="mt-it">
<span class="mt-lb">Clarity</span>
<div class="mt-br">
<div class="mt-fl" id="clarityBar" style="width:0%"></div>
</div>
<span class="mt-vl" id="clarityVal">-</span>
</div>
</div>
</div>
</div>
<div class="rs" id="result"></div>
</main>
<script>
const optimizeBtn = document.getElementById('optimizeBtn') as HTMLButtonElement;
const contentArea = document.getElementById('content') as HTMLTextAreaElement;
const resultDiv = document.getElementById('result') as HTMLDivElement;
const readabilityBar = document.getElementById('readabilityBar') as HTMLDivElement;
const engagementBar = document.getElementById('engagementBar') as HTMLDivElement;
const clarityBar = document.getElementById('clarityBar') as HTMLDivElement;
const readabilityVal = document.getElementById('readabilityVal') as HTMLSpanElement;
const engagementVal = document.getElementById('engagementVal') as HTMLSpanElement;
const clarityVal = document.getElementById('clarityVal') as HTMLSpanElement;

optimizeBtn.addEventListener('click', async () => {
  const content = contentArea.value.trim();

  if (!content) {
    resultDiv.innerHTML = '<div class="er">Please enter content to optimize</div>';
    resultDiv.style.display = 'block';
    return;
  }

  optimizeBtn.disabled = true;
  optimizeBtn.textContent = 'Optimizing...';
  resultDiv.innerHTML = '<div class="ld">Optimizing content with AI...</div>';
  resultDiv.style.display = 'block';

  await new Promise(resolve => setTimeout(resolve, 1500));

  const wordCount = content.split(/\s+/).length;
  const hasHeaders = /#{1,6}\s|<h[1-6]>/i.test(content);
  const hasBullets = /[-*â€¢]\s|\d+\.\s|<li>/i.test(content);
  const avgWordLength = content.replace(/\s+/g, '').length / wordCount;

  const readability = Math.min(95, 65 + (hasHeaders ? 10 : 0) + (hasBullets ? 10 : 0) + Math.floor(Math.random() * 10));
  const engagement = Math.min(92, 60 + (wordCount > 100 ? 15 : 5) + (hasBullets ? 10 : 0) + Math.floor(Math.random() * 12));
  const clarity = Math.min(90, 70 + (avgWordLength < 6 ? 10 : 0) + (hasHeaders ? 8 : 0) + Math.floor(Math.random() * 8));

  readabilityBar.style.width = `${readability}%`;
  engagementBar.style.width = `${engagement}%`;
  clarityBar.style.width = `${clarity}%`;
  readabilityVal.textContent = `${readability}%`;
  engagementVal.textContent = `${engagement}%`;
  clarityVal.textContent = `${clarity}%`;

  const paragraphs = content.split(/\n\n+/);
  const optimizedParagraphs = paragraphs.map(para => {
    if (para.trim().length === 0) return '';

    let optimized = para.trim();

    if (!optimized.match(/^#{1,6}\s|<h[1-6]>/i) && optimized.length > 150) {
      const sentences = optimized.match(/[^.!?]+[.!?]+/g) || [optimized];
      if (sentences.length > 2) {
        const midPoint = Math.floor(sentences.length / 2);
        optimized = sentences.slice(0, midPoint).join(' ') + '\n\n' + sentences.slice(midPoint).join(' ');
      }
    }

    return optimized;
  });

  let optimizedContent = optimizedParagraphs.join('\n\n');

  if (!hasHeaders && wordCount > 100) {
    optimizedContent = '## Key Points\n\n' + optimizedContent;
  }

  resultDiv.innerHTML = `
    <div class="rs-hd">Optimized Content</div>
    <div class="ct">${optimizedContent.replace(/\n/g, '<br>')}</div>
    <div class="sg-sec">
      <div class="sg-hd">Optimization Suggestions</div>
      <ul class="sg-ls">
        ${!hasHeaders ? '<li class="sg-it">âœ“ Added section headers for better structure</li>' : ''}
        ${optimizedParagraphs.length > paragraphs.length ? '<li class="sg-it">âœ“ Split long paragraphs for improved readability</li>' : ''}
        <li class="sg-it">âœ“ Enhanced content flow and transitions</li>
        <li class="sg-it">âœ“ Improved sentence structure and clarity</li>
        ${wordCount < 150 ? '<li class="sg-it">âš  Consider expanding content (current: ' + wordCount + ' words, recommended: 300+)</li>' : ''}
        ${!hasBullets && wordCount > 200 ? '<li class="sg-it">ðŸ’¡ Add bullet points or lists to highlight key information</li>' : ''}
      </ul>
    </div>
  `;

  optimizeBtn.disabled = false;
  optimizeBtn.textContent = 'Optimize Content';
});
</script>
</Layout>
<style>.mn{margin-left:240px;padding:32px;min-height:100vh;max-width:1400px;animation:sf .4s ease}.hd{margin-bottom:24px}.tl{font-size:32px;font-weight:700;margin:0 0 6px 0;color:#1f2937}.st{font-size:15px;color:#6b7280;margin:0}.gr{display:grid;grid-template-columns:1fr 1fr;gap:24px;margin-bottom:24px}.sc{background:#fff;border:2px solid #e5e7eb;border-radius:16px;padding:24px;display:flex;flex-direction:column;gap:18px;box-shadow:0 2px 8px rgba(0,0,0,.06),0 8px 24px rgba(0,0,0,.04)}.tx{width:100%;min-height:320px;background:#fafafa;border:2px solid #e5e7eb;border-radius:12px;padding:18px;font-size:14px;color:#1f2937;font-family:inherit;line-height:1.8;resize:vertical;box-shadow:inset 0 2px 4px rgba(0,0,0,.04)}.tx:focus{outline:none;border-color:#10b981;background:#fff;box-shadow:0 0 0 3px rgba(16,185,129,.1),inset 0 2px 4px rgba(0,0,0,.04)}.tx::placeholder{color:#9ca3af}.bt{background:linear-gradient(135deg,#10b981,#059669);border:none;border-radius:10px;padding:13px 24px;font-size:14px;font-weight:700;color:#fff;cursor:pointer;transition:all .25s cubic-bezier(.4,0,.2,1);box-shadow:0 2px 6px rgba(16,185,129,.3),inset 0 1px 0 rgba(255,255,255,.3)}.bt:hover:not(:disabled){transform:translateY(-2px);box-shadow:0 4px 12px rgba(16,185,129,.4),inset 0 1px 0 rgba(255,255,255,.3)}.bt:active{transform:translateY(0)}.bt:disabled{opacity:.6;cursor:not-allowed}.mt{display:flex;flex-direction:column;gap:24px}.mt-it{display:flex;flex-direction:column;gap:10px}.mt-lb{font-size:14px;font-weight:600;color:#374151}.mt-br{width:100%;height:10px;background:#e5e7eb;border-radius:6px;overflow:hidden;box-shadow:inset 0 1px 3px rgba(0,0,0,.1)}.mt-fl{height:100%;background:linear-gradient(90deg,#10b981,#059669);border-radius:6px;transition:width .4s cubic-bezier(.4,0,.6,1);box-shadow:0 0 8px rgba(16,185,129,.3)}.mt-vl{font-size:13px;color:#10b981;font-weight:700}.rs{background:#fff;border:2px solid #e5e7eb;border-radius:16px;padding:32px;box-shadow:0 2px 8px rgba(0,0,0,.06),0 8px 24px rgba(0,0,0,.04);display:none}.rs-hd{font-size:18px;font-weight:700;color:#1f2937;margin-bottom:16px;padding-bottom:12px;border-bottom:2px solid #f3f4f6}.ld,.er{padding:32px;text-align:center;font-size:14px}.ld{color:#10b981}.er{color:#ef4444}.ct{color:#1f2937;font-size:15px;line-height:1.8;white-space:pre-wrap}.sg-sec{margin-top:28px;padding-top:28px;border-top:2px solid #f3f4f6}.sg-hd{font-size:16px;font-weight:700;color:#1f2937;margin-bottom:14px}.sg-ls{list-style:none;padding:0;margin:0;display:flex;flex-direction:column;gap:10px}.sg-it{padding:12px 16px;background:#f8fafc;border-left:3px solid #10b981;border-radius:6px;font-size:14px;color:#374151;line-height:1.6}@media(max-width:768px){.mn{margin-left:72px;padding:20px}.gr{grid-template-columns:1fr}}@media(max-width:480px){.mn{margin-left:0;padding:16px;padding-top:80px}}</style>
